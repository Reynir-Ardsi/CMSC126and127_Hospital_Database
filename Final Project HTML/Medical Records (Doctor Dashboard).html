<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Medical Records</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #ECEFCA;
    }

    .header {
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: #213448;
      color: white;
      padding: 20px;
      position: relative;
      margin-bottom: 20px;
    }

    .back-button {
      position: absolute;
      left: 20px;
      font-size: 20px;
      color: white;
      background: none;
      border: none;
      cursor: pointer;
    }

    .header h2 {
      margin: 0;
      font-weight: bold;
    }

    .content {
      padding: 10px;
    }

    .top-section {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }

    .profile-pic {
      width: 200px;
      height: 200px;
      background-image: url("pictures/defaultpfp.jpg");
      background-size: 110%;
      background-position: center;
      background-repeat: no-repeat;
      background-color: white;
      border: 5px solid #213448;
      text-align: center;
      font-size: 10px;
      padding: 5px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-weight: bold;
    }

    .info-box {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      height: auto;
      border: 5px solid #213448;
      padding: 10px;
      background-color: white;
      font-size: 16px;
      font-weight: bold;
    }

    .info-box p {
      margin: 0;
    }

    .notes-box {
      border: 5px solid #213448;
      height: 500px;
      overflow-y: scroll;
      background-color: #c3c3c3;
      padding: 20px;
      text-align: left;
      font-weight: bold;
      font-size: 18px;
    }

    .note {
      margin-top: 10px;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 15px;
      background-color: #f0f0f0;
      padding: 5px 5px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 20px;
      font-weight: normal;
      width: 95%;
    }

    .text-format {
      columns: 2;
    }

    /* Style for textarea */
    textarea {
      width: 100%;
      height: 300px;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 5px;
      resize: none;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: left;
    }

    th {
      background-color: #213448;
      color: white;
    }

  </style>
</head>
<body>

  <div class="header">
    <button class="back-button" onclick="history.back()">←</button>
    <h2>Medical Records</h2>
  </div>

  <div class="content">
    <div class="top-section">
      <div class="profile-pic"></div>
      <div class="info-box">
        <p>Full Name: Johnathan Michael Doe</p>
        <p>Date of Birth: January 15, 1985</p>
        <p>Age: 40 years</p>
        <p>Gender: Male</p>
        <p>Address: 123 Maple Street, Springfield, IL 62704</p>
        <p>Phone Number: (555) 123-4567</p>
        <p>Email: johndoe@example.com</p>
        <p>Emergency Contact: Jane Doe (Wife) — (555) 987-6543</p>
        <p>Marital Status: Married</p>
        <p>Occupation: Software Engineer</p>
        <p>Insurance Provider: HealthCare Plus — Policy #HC123456789</p>
        <p>Primary Care Physician: Dr. Jane Smith</p>
        <p>Allergies: Penicillin (rash)</p>
        <p>Medical History: Hypertension, Type 2 Diabetes Mellitus</p>
        <p>Medications: Lisinopril 10 mg daily, Metformin 500 mg twice daily</p>
        <p>Lifestyle: Non-smoker, occasional alcohol use, exercises 3x/week</p>
      </div>
    </div>

    <table id="patient-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Name</th>
          <th>Age</th>
          <th>Gender</th>
          <th>Diagnosis</th>
        </tr>
      </thead>
      <tbody>
        <!-- Patient data will be dynamically inserted here -->
      </tbody>
    </table>

    <div class="notes-box">
      <div class="note">
        <textarea readonly>
Patient Name: John Doe
Date: May 20, 2025
Provider: Dr. Jane Smith
Visit Type: Follow-up for hypertension

S – Subjective:
Patient reports occasional headaches and dizziness, especially in the morning. He notes that he has been inconsistent with taking his blood pressure medication over the past week due to travel. No chest pain, shortness of breath, or visual disturbances. Denies other symptoms.

O – Objective:
Blood pressure: 158/95 mmHg
Heart rate: 78 bpm
Respiratory rate: 16/min
Temperature: 98.6°F
Weight: 190 lbs (up 3 lbs since last visit)
Physical exam: Alert and oriented ×3, no edema, lungs clear, heart sounds regular

A – Assessment:
Primary: Hypertension, uncontrolled (I10)
Secondary: Medication noncompliance
No signs of hypertensive crisis or end-organ damage at this time

P – Plan:
Reinforce importance of daily antihypertensive medication
Restart Lisinopril 10 mg once daily
Monitor blood pressure at home twice daily and keep a log
Schedule follow-up visit in 2 weeks
Educate patient on dietary sodium reduction and importance of adherence
        </textarea>
      </div>
      <div class="note">
        <textarea readonly>
Patient Name: John Doe
Date: May 21, 2025
Provider: Dr. Jane Smith
Visit Type: Acute illness

S – Subjective:
Patient complains of nasal congestion, sore throat, and mild cough for the past 3 days. Reports mild fatigue but no fever or shortness of breath. No chest pain or headaches.

O – Objective:
Temperature: 99.1°F
Heart rate: 80 bpm
Respiratory rate: 18/min
Oxygen saturation: 98% on room air
Throat exam: Mild erythema, no exudates
Lungs: Clear to auscultation bilaterally
No lymphadenopathy

A – Assessment:
Upper respiratory infection, likely viral
No signs of bacterial infection or pneumonia

P – Plan:
Supportive care: rest, hydration, saline nasal spray
Over-the-counter acetaminophen for sore throat
Educate on signs of worsening (fever > 101°F, difficulty breathing)
Follow-up if symptoms worsen or persist beyond 10 days
        </textarea>
      </div>
      <div class="note">
        <textarea readonly>
Patient Name: John Doe
Date: May 22, 2025
Provider: Dr. Jane Smith
Visit Type: Diabetes management follow-up

S – Subjective:
Patient reports feeling well overall. Has been monitoring blood glucose regularly with occasional readings above target (mostly fasting levels around 140 mg/dL). No symptoms of hypoglycemia. Diet and exercise reported as “fair.” No recent infections or hospitalizations.

O – Objective:
Weight: 185 lbs (down 5 lbs since last visit)
Blood pressure: 130/80 mmHg
HbA1c: 7.4% (lab result)
Foot exam: No ulcers or lesions, good pulses
No signs of diabetic retinopathy (last eye exam 6 months ago)

A – Assessment:
Type 2 diabetes mellitus, suboptimally controlled
Blood pressure controlled

P – Plan:
Adjust metformin dosage to 1000 mg twice daily
Reinforce diet and exercise counseling
Refer to diabetes educator for nutrition support
Schedule HbA1c recheck in 3 months
Annual eye exam reminder
Continue blood pressure management
        </textarea>
      </div>
    </div>
  </div>

  <script>
    // Fetch patient data from the PHP file and populate the patient table
    function loadPatients() {
      fetch('getPatients.php') // Adjust path if needed
        .then(response => response.json())
        .then(data => {
          const tableBody = document.querySelector('#patient-table tbody');
          tableBody.innerHTML = '';  // Clear any existing rows

          data.forEach(patient => {
            const row = document.createElement('tr');
            row.addEventListener('click', () => showPatientProfile(patient));

            const idCell = document.createElement('td');
            idCell.textContent = patient.id;
            row.appendChild(idCell);

            const nameCell = document.createElement('td');
            nameCell.textContent = patient.name;
            row.appendChild(nameCell);

            const ageCell = document.createElement('td');
            ageCell.textContent = patient.age;
            row.appendChild(ageCell);

            const genderCell = document.createElement('td');
            genderCell.textContent = patient.gender;
            row.appendChild(genderCell);

            const diagnosisCell = document.createElement('td');
            diagnosisCell.textContent = patient.diagnosis;
            row.appendChild(diagnosisCell);

            tableBody.appendChild(row);
          });
        })
        .catch(error => console.error('Error fetching patient data:', error));
    }

    // Display the patient's profile info when clicked on a patient row
    function showPatientProfile(patient) {
      document.querySelector('.profile-pic').style.backgroundImage = `url('pictures/${patient.profile_pic || "defaultpfp.jpg"}')`;  // Assuming you have a profile picture field in DB
      const infoBox = document.querySelector('.info-box');
      infoBox.innerHTML = `
        <p>Full Name: ${patient.name}</p>
        <p>Date of Birth: ${patient.dob}</p>
        <p>Age: ${patient.age} years</p>
        <p>Gender: ${patient.gender}</p>
        <p>Address: ${patient.address}</p>
        <p>Phone Number: ${patient.phone}</p>
        <p>Email: ${patient.email}</p>
        <p>Emergency Contact: ${patient.emergency_contact}</p>
        <p>Marital Status: ${patient.marital_status}</p>
        <p>Occupation: ${patient.occupation}</p>
        <p>Insurance Provider: ${patient.insurance_provider}</p>
        <p>Primary Care Physician: ${patient.primary_care_physician}</p>
        <p>Allergies: ${patient.allergies}</p>
        <p>Medical History: ${patient.medical_history}</p>
        <p>Medications: ${patient.medications}</p>
        <p>Lifestyle: ${patient.lifestyle}</p>
      `;
    }

    // Fetch patients when the page is loaded
    window.onload = loadPatients;
  </script>

</body>
</html>
